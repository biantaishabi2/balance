# è´¢åŠ¡å»ºæ¨¡æ¶æ„è®¾è®¡

## æ¦‚è¿°

æœ¬æ–‡æ¡£æè¿°äº† AI è¾…åŠ©è´¢åŠ¡å»ºæ¨¡çš„æ¶æ„è®¾è®¡ã€‚æ ¸å¿ƒæ€æƒ³æ˜¯ï¼š**äººæœºåˆ†ç¦»ï¼Œå„å¸å…¶èŒ**ã€‚

- **äººç±»**ï¼šæä¾›å‡è®¾ã€å®¡æ ¸ç»“æœã€åšå†³ç­–
- **æœºå™¨**ï¼šé«˜æ•ˆè®¡ç®—ã€è¿½æº¯è®°å½•ã€æ ¼å¼åŒ–è¾“å‡º

AI ä¸éœ€è¦æ¨¡ä»¿äººç±»åœ¨ Excel é‡Œå†™å…¬å¼çš„æ–¹å¼ï¼Œè€Œæ˜¯ç”¨æ›´é«˜æ•ˆçš„æ–¹å¼ï¼ˆPython/Pandasï¼‰è®¡ç®—ï¼Œç„¶åæŠŠç»“æœå‘ˆç°åœ¨äººç±»ç†Ÿæ‚‰çš„ç•Œé¢ï¼ˆExcel/Webï¼‰ã€‚

---

## æ¶æ„æ€»è§ˆ

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                           è´¢åŠ¡å»ºæ¨¡æ¶æ„                                    â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                                         â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”      â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”      â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”             â”‚
â”‚  â”‚   è¾“å…¥å±‚    â”‚      â”‚   è®¡ç®—å±‚    â”‚      â”‚   è¾“å‡ºå±‚    â”‚              â”‚
â”‚  â”‚  (äºº â†’ æœº)  â”‚ â”€â”€â†’ â”‚  (æœºå™¨å·¥ä½œ)  â”‚ â”€â”€â†’ â”‚  (æœº â†’ äºº)  â”‚              â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜      â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜      â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜             â”‚
â”‚        â”‚                    â”‚                    â”‚                      â”‚
â”‚        â–¼                    â–¼                    â–¼                      â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”      â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”      â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”             â”‚
â”‚  â”‚ â€¢ Excelæ¨¡æ¿ â”‚      â”‚ â€¢ Python    â”‚      â”‚ â€¢ ExcelæŠ¥è¡¨ â”‚             â”‚
â”‚  â”‚ â€¢ Webè¡¨å•   â”‚      â”‚ â€¢ Pandas    â”‚      â”‚ â€¢ Webä»ªè¡¨ç›˜ â”‚             â”‚
â”‚  â”‚ â€¢ JSON/YAML â”‚      â”‚ â€¢ å…¬å¼è¿½æº¯  â”‚      â”‚ â€¢ PDFæŠ¥å‘Š   â”‚             â”‚
â”‚  â”‚ â€¢ CLIå‚æ•°   â”‚      â”‚ â€¢ ä¾èµ–é“¾    â”‚      â”‚ â€¢ å›¾è¡¨      â”‚             â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜      â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜      â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜             â”‚
â”‚                                                                         â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

---

## æ ¸å¿ƒåŸåˆ™

### 1. äººæœºåˆ†ç¦»

| è§’è‰² | å·¥ä½œå†…å®¹ | å·¥å…· |
|------|---------|------|
| **äººç±»** | æä¾›å‡è®¾ï¼ˆå¢é•¿ç‡ã€æ¯›åˆ©ç‡ç­‰ï¼‰ | Excel/Webè¡¨å• |
| **äººç±»** | å®¡æ ¸ç»“æœã€åšå•†ä¸šåˆ¤æ–­ | æŠ¥è¡¨/ä»ªè¡¨ç›˜ |
| **æœºå™¨** | é«˜æ•ˆè®¡ç®—ä¸‰è¡¨è”åŠ¨ | Python/Pandas |
| **æœºå™¨** | è®°å½•æ¯ä¸ªæ•°å­—çš„æ¥æºå’Œå…¬å¼ | ç»“æ„åŒ–JSON |
| **æœºå™¨** | æ ¼å¼åŒ–è¾“å‡º | Excel/PDFç”Ÿæˆ |

### 2. å®Œå…¨å¯è¿½æº¯

**æ¯ä¸ªæ•°å­—éƒ½å¿…é¡»è®°å½•**ï¼š
- å€¼æ˜¯å¤šå°‘
- å…¬å¼æ˜¯ä»€ä¹ˆ
- ä¾èµ–å“ªäº›è¾“å…¥
- æ¥æºæ˜¯ä»€ä¹ˆ

### 3. æ ¼å¼åˆ†ç¦»

- **å­˜å‚¨æ ¼å¼**ï¼šJSONï¼ˆæœºå™¨å‹å¥½ï¼Œå¸¦è¿½æº¯ä¿¡æ¯ï¼‰
- **å±•ç¤ºæ ¼å¼**ï¼šExcel/Web/PDFï¼ˆäººç±»å‹å¥½ï¼‰

---

## æ•°æ®ç»“æ„è®¾è®¡

### ModelCell ç±»

```python
from dataclasses import dataclass
from typing import Dict, List, Optional

@dataclass
class ModelCell:
    """
    è´¢åŠ¡æ¨¡å‹ä¸­çš„ä¸€ä¸ªå•å…ƒæ ¼
    ä¸åªå­˜å€¼ï¼Œè¿˜å­˜è¿™ä¸ªå€¼æ˜¯æ€ä¹ˆæ¥çš„
    """
    value: float                      # è®¡ç®—ç»“æœ
    formula: str                      # å…¬å¼æè¿°ï¼ˆäººç±»å¯è¯»ï¼‰
    formula_code: str                 # å…¬å¼ä»£ç ï¼ˆå¯æ‰§è¡Œï¼‰
    inputs: Dict[str, float]          # ä¾èµ–çš„è¾“å…¥å€¼
    dependencies: List[str]           # ä¾èµ–çš„å…¶ä»–cellåç§°
    source: str                       # æ•°æ®æ¥æº
    unit: str = "ä¸‡å…ƒ"                # å•ä½
    note: Optional[str] = None        # å¤‡æ³¨

# ä½¿ç”¨ç¤ºä¾‹
revenue = ModelCell(
    value=30854846.58,
    formula="ä¸ŠæœŸæ”¶å…¥ Ã— (1 + å¢é•¿ç‡)",
    formula_code="last_revenue * (1 + growth_rate)",
    inputs={
        "last_revenue": 28307198.70,
        "growth_rate": 0.09
    },
    dependencies=["last_revenue", "growth_rate"],
    source="assumptions.json",
    unit="ä¸‡å…ƒ"
)

net_income = ModelCell(
    value=2738464.94,
    formula="ç¨å‰åˆ©æ¶¦ Ã— (1 - ç¨ç‡)",
    formula_code="ebt * (1 - tax_rate)",
    inputs={
        "ebt": 3175000.00,
        "tax_rate": 0.1386
    },
    dependencies=["revenue", "cost", "opex", "interest", "ebt", "tax_rate"],
    source="forecast.py:step_profit()",
    unit="ä¸‡å…ƒ"
)
```

### å®Œæ•´æ¨¡å‹è¾“å‡ºç»“æ„

```json
{
  "_meta": {
    "model_name": "å®å¾·æ—¶ä»£ä¸‰è¡¨æ¨¡å‹",
    "scenario": "base_case",
    "created_at": "2025-12-02T13:00:00",
    "base_data_source": "2025Q3å­£æŠ¥"
  },

  "assumptions": {
    "growth_rate": {
      "value": 0.09,
      "label": "æ”¶å…¥å¢é•¿ç‡",
      "source": "ç”¨æˆ·è¾“å…¥",
      "editable": true
    },
    "gross_margin": {
      "value": 0.253,
      "label": "æ¯›åˆ©ç‡",
      "source": "å†å²å¹³å‡",
      "editable": true
    }
  },

  "income_statement": {
    "revenue": {
      "value": 30854846.58,
      "formula": "last_revenue Ã— (1 + growth_rate)",
      "inputs": {
        "last_revenue": 28307198.70,
        "growth_rate": 0.09
      },
      "source": "assumptions.growth_rate"
    },
    "cost": {
      "value": 23048570.40,
      "formula": "revenue Ã— (1 - gross_margin)",
      "inputs": {
        "revenue": 30854846.58,
        "gross_margin": 0.253
      },
      "source": "assumptions.gross_margin"
    },
    "gross_profit": {
      "value": 7806276.18,
      "formula": "revenue - cost",
      "inputs": {
        "revenue": 30854846.58,
        "cost": 23048570.40
      },
      "dependency_chain": ["revenue", "cost"]
    },
    "net_income": {
      "value": 2738464.94,
      "formula": "ebt - tax",
      "inputs": {
        "ebt": 3175000.00,
        "tax": 436535.06
      },
      "dependency_chain": [
        "revenue",
        "cost",
        "gross_profit",
        "opex",
        "ebit",
        "interest",
        "ebt",
        "tax"
      ]
    }
  },

  "balance_sheet": {
    "total_assets": {
      "value": 58154126.99,
      "formula": "cash + receivable + inventory + fixed_assets",
      "inputs": {...},
      "balanced_with": "total_liabilities + total_equity"
    }
  },

  "cash_flow": {
    "operating_cf": {
      "value": 4047426.80,
      "formula": "net_income + depreciation - delta_working_capital",
      "inputs": {...}
    }
  },

  "validation": {
    "balance_sheet_balanced": true,
    "cash_flow_balanced": true,
    "all_formulas_valid": true
  }
}
```

---

## äººæœºäº¤äº’è®¾è®¡

### è¾“å…¥ç•Œé¢

ç”¨æˆ·é€šè¿‡ç®€å•çš„ç•Œé¢è¾“å…¥å‡è®¾ï¼Œä¸éœ€è¦ç†è§£å¤æ‚çš„å…¬å¼ï¼š

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  ğŸ“Š è´¢åŠ¡å»ºæ¨¡å·¥å…·                                                 â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                                 â”‚
â”‚  åŸºç¡€æ•°æ®: [å®å¾·æ—¶ä»£2025Q3å­£æŠ¥]  [ğŸ“ ä¸Šä¼ æ–°æ–‡ä»¶]                  â”‚
â”‚                                                                 â”‚
â”‚  â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€ â”‚
â”‚                                                                 â”‚
â”‚  ğŸ¯ é€‰æ‹©æƒ…æ™¯:                                                   â”‚
â”‚     â—‹ Base Case (ç»´æŒå½“å‰è¶‹åŠ¿)                                  â”‚
â”‚     â—‹ Bull Case (ä¹è§‚æƒ…æ™¯)                                      â”‚
â”‚     â—‹ Bear Case (æ‚²è§‚æƒ…æ™¯)                                      â”‚
â”‚     â—‹ Custom    (è‡ªå®šä¹‰)                                        â”‚
â”‚                                                                 â”‚
â”‚  â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€ â”‚
â”‚                                                                 â”‚
â”‚  ğŸ“ˆ é©±åŠ¨å‡è®¾:                                                   â”‚
â”‚                                                                 â”‚
â”‚     æ”¶å…¥å¢é•¿ç‡     [====â—=====] 9.0%                            â”‚
â”‚     æ¯›åˆ©ç‡         [=====â—====] 25.3%                           â”‚
â”‚     è´¹ç”¨ç‡         [===â—======] 9.7%                            â”‚
â”‚     èµ„æœ¬æ”¯å‡ºæ¯”     [==â—=======] 4.2%                            â”‚
â”‚     åº”æ”¶å‘¨è½¬å¤©æ•°   [=====â—====] 64 å¤©                           â”‚
â”‚     åº”ä»˜å‘¨è½¬å¤©æ•°   [========â—=] 120 å¤©                          â”‚
â”‚                                                                 â”‚
â”‚  â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€ â”‚
â”‚                                                                 â”‚
â”‚  [â–¶ è¿è¡Œæ¨¡å‹]   [ğŸ“Š å¯¹æ¯”æƒ…æ™¯]   [ğŸ“¥ å¯¼å‡ºExcel]   [ğŸ“„ ç”ŸæˆæŠ¥å‘Š]   â”‚
â”‚                                                                 â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### è¾“å‡ºç•Œé¢ï¼ˆå¯è¿½æº¯ï¼‰

ç‚¹å‡»ä»»ä½•æ•°å­—éƒ½å¯ä»¥çœ‹åˆ°å®ƒçš„è®¡ç®—è¿‡ç¨‹ï¼š

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  ğŸ“ˆ åˆ©æ¶¦è¡¨é¢„æµ‹                                        [Base Case] â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                                 â”‚
â”‚  ç§‘ç›®                    é‡‘é¢(ä¸‡å…ƒ)         åŒæ¯”      [è¿½æº¯]    â”‚
â”‚  â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€  â”‚
â”‚  è¥ä¸šæ”¶å…¥              30,854,846.58      +9.0%      [?]       â”‚
â”‚  è¥ä¸šæˆæœ¬             (23,048,570.40)     +9.0%      [?]       â”‚
â”‚  æ¯›åˆ©                   7,806,276.18     +10.7%      [?]       â”‚
â”‚  â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€  â”‚
â”‚  è¥ä¸šè´¹ç”¨             (2,992,920.12)      +8.6%      [?]       â”‚
â”‚  è¥ä¸šåˆ©æ¶¦               4,813,356.06     +12.3%      [?]       â”‚
â”‚  â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€  â”‚
â”‚  åˆ©æ¯è´¹ç”¨               (217,830.94)                 [?]       â”‚
â”‚  ç¨å‰åˆ©æ¶¦               3,175,000.00                 [?]       â”‚
â”‚  æ‰€å¾—ç¨                  (436,535.06)                [?]       â”‚
â”‚  â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€  â”‚
â”‚  å‡€åˆ©æ¶¦                 2,738,464.94     +9.4%       [?] â†ç‚¹å‡»  â”‚
â”‚                                                                 â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                              â”‚
                              â–¼ (ç‚¹å‡»åå±•å¼€)
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  ğŸ“ å‡€åˆ©æ¶¦è¿½æº¯                                                   â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                                 â”‚
â”‚  å…¬å¼:  ç¨å‰åˆ©æ¶¦ Ã— (1 - ç¨ç‡)                                    â”‚
â”‚                                                                 â”‚
â”‚  è®¡ç®—:  3,175,000.00 Ã— (1 - 13.86%)                             â”‚
â”‚         = 3,175,000.00 Ã— 0.8614                                 â”‚
â”‚         = 2,738,464.94                                          â”‚
â”‚                                                                 â”‚
â”‚  ä¾èµ–é“¾:                                                        â”‚
â”‚    æ”¶å…¥ (30,854,846)                                            â”‚
â”‚      â†“ - æˆæœ¬ (23,048,570)                                      â”‚
â”‚    æ¯›åˆ© (7,806,276)                                             â”‚
â”‚      â†“ - è´¹ç”¨ (2,992,920)                                       â”‚
â”‚    è¥ä¸šåˆ©æ¶¦ (4,813,356)                                         â”‚
â”‚      â†“ - åˆ©æ¯ (217,830)                                         â”‚
â”‚    ç¨å‰åˆ©æ¶¦ (3,175,000)                                         â”‚
â”‚      â†“ - æ‰€å¾—ç¨ (436,535)                                       â”‚
â”‚    å‡€åˆ©æ¶¦ (2,738,464) â† å½“å‰                                    â”‚
â”‚                                                                 â”‚
â”‚  æ¥æº:  forecast.py â†’ step_profit()                             â”‚
â”‚  å‡è®¾:  tax_rate = 13.86% (æ¥è‡ª assumptions.json)               â”‚
â”‚                                                                 â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

---

## æ¨¡å—è®¾è®¡

### ç›®å½•ç»“æ„

```
financial_model/
â”‚
â”œâ”€â”€ core/                          # æ ¸å¿ƒæ¨¡å—
â”‚   â”œâ”€â”€ __init__.py
â”‚   â”œâ”€â”€ cell.py                   # ModelCell ç±»å®šä¹‰
â”‚   â”œâ”€â”€ model.py                  # æ¨¡å‹åŸºç±»
â”‚   â””â”€â”€ tracer.py                 # è¿½æº¯è®°å½•å™¨
â”‚
â”œâ”€â”€ models/                        # è®¡ç®—æ¨¡å‹
â”‚   â”œâ”€â”€ __init__.py
â”‚   â”œâ”€â”€ income_statement.py       # åˆ©æ¶¦è¡¨æ¨¡å‹
â”‚   â”œâ”€â”€ balance_sheet.py          # èµ„äº§è´Ÿå€ºè¡¨æ¨¡å‹
â”‚   â”œâ”€â”€ cash_flow.py              # ç°é‡‘æµé‡è¡¨æ¨¡å‹
â”‚   â”œâ”€â”€ three_statement.py        # ä¸‰è¡¨è”åŠ¨
â”‚   â””â”€â”€ dcf.py                    # DCFä¼°å€¼ï¼ˆæ‰©å±•ï¼‰
â”‚
â”œâ”€â”€ drivers/                       # é©±åŠ¨å› å­
â”‚   â”œâ”€â”€ __init__.py
â”‚   â”œâ”€â”€ revenue.py                # æ”¶å…¥é©±åŠ¨
â”‚   â”œâ”€â”€ cost.py                   # æˆæœ¬é©±åŠ¨
â”‚   â””â”€â”€ working_capital.py        # è¥è¿èµ„æœ¬é©±åŠ¨
â”‚
â”œâ”€â”€ io/                            # è¾“å…¥è¾“å‡º
â”‚   â”œâ”€â”€ __init__.py
â”‚   â”œâ”€â”€ excel_reader.py           # Excelè¯»å–
â”‚   â”œâ”€â”€ excel_writer.py           # Excelå†™å…¥ï¼ˆå¸¦è¿½æº¯ï¼‰
â”‚   â”œâ”€â”€ json_io.py                # JSONè¯»å†™
â”‚   â””â”€â”€ pdf_generator.py          # PDFæŠ¥å‘Šç”Ÿæˆ
â”‚
â”œâ”€â”€ ui/                            # ç”¨æˆ·ç•Œé¢ï¼ˆå¯é€‰ï¼‰
â”‚   â”œâ”€â”€ __init__.py
â”‚   â”œâ”€â”€ cli.py                    # å‘½ä»¤è¡Œç•Œé¢
â”‚   â””â”€â”€ web/                      # Webç•Œé¢
â”‚       â”œâ”€â”€ app.py
â”‚       â”œâ”€â”€ templates/
â”‚       â””â”€â”€ static/
â”‚
â”œâ”€â”€ templates/                     # æ¨¡æ¿
â”‚   â”œâ”€â”€ assumptions.yaml          # å‡è®¾æ¨¡æ¿
â”‚   â”œâ”€â”€ output_excel.xlsx         # Excelè¾“å‡ºæ¨¡æ¿
â”‚   â””â”€â”€ report.md                 # æŠ¥å‘Šæ¨¡æ¿
â”‚
â””â”€â”€ examples/                      # ç¤ºä¾‹
    â”œâ”€â”€ catl_2025q3/              # å®å¾·æ—¶ä»£æ¡ˆä¾‹
    â””â”€â”€ demo/                     # æ¼”ç¤ºæ¡ˆä¾‹
```

### æ ¸å¿ƒç±»è®¾è®¡

```python
# core/cell.py

from dataclasses import dataclass, field
from typing import Dict, List, Optional, Any
import json

@dataclass
class ModelCell:
    """æ¨¡å‹å•å…ƒæ ¼ - å¸¦å®Œæ•´è¿½æº¯ä¿¡æ¯"""

    name: str                                    # å­—æ®µå
    value: float                                 # è®¡ç®—å€¼
    formula: str                                 # å…¬å¼ï¼ˆäººç±»å¯è¯»ï¼‰
    formula_code: str = ""                       # å…¬å¼ä»£ç 
    inputs: Dict[str, float] = field(default_factory=dict)
    dependencies: List[str] = field(default_factory=list)
    source: str = ""
    unit: str = "ä¸‡å…ƒ"
    note: Optional[str] = None

    def to_dict(self) -> Dict[str, Any]:
        """è½¬æ¢ä¸ºå­—å…¸ï¼ˆç”¨äºJSONåºåˆ—åŒ–ï¼‰"""
        return {
            "value": self.value,
            "formula": self.formula,
            "inputs": self.inputs,
            "dependencies": self.dependencies,
            "source": self.source,
            "unit": self.unit,
            "note": self.note
        }

    def explain(self) -> str:
        """ç”Ÿæˆäººç±»å¯è¯»çš„è§£é‡Š"""
        lines = [
            f"ã€{self.name}ã€‘",
            f"  å€¼: {self.value:,.2f} {self.unit}",
            f"  å…¬å¼: {self.formula}",
            f"  è®¡ç®—è¿‡ç¨‹:"
        ]

        # å±•ç¤ºè¾“å…¥å€¼
        for key, val in self.inputs.items():
            lines.append(f"    {key} = {val:,.2f}")

        lines.append(f"  æ¥æº: {self.source}")

        if self.dependencies:
            lines.append(f"  ä¾èµ–: {' â†’ '.join(self.dependencies)}")

        return "\n".join(lines)


# core/model.py

class FinancialModel:
    """è´¢åŠ¡æ¨¡å‹åŸºç±»"""

    def __init__(self, name: str):
        self.name = name
        self.cells: Dict[str, ModelCell] = {}
        self.assumptions: Dict[str, Any] = {}

    def set_assumption(self, key: str, value: float, source: str = "ç”¨æˆ·è¾“å…¥"):
        """è®¾ç½®å‡è®¾"""
        self.assumptions[key] = {
            "value": value,
            "source": source
        }

    def add_cell(self, cell: ModelCell):
        """æ·»åŠ è®¡ç®—å•å…ƒ"""
        self.cells[cell.name] = cell

    def get_cell(self, name: str) -> Optional[ModelCell]:
        """è·å–å•å…ƒæ ¼"""
        return self.cells.get(name)

    def explain(self, cell_name: str) -> str:
        """è§£é‡ŠæŸä¸ªå•å…ƒæ ¼"""
        cell = self.get_cell(cell_name)
        if cell:
            return cell.explain()
        return f"æœªæ‰¾åˆ°: {cell_name}"

    def to_json(self) -> str:
        """å¯¼å‡ºä¸ºJSON"""
        data = {
            "_meta": {
                "model_name": self.name,
                "created_at": datetime.now().isoformat()
            },
            "assumptions": self.assumptions,
            "cells": {
                name: cell.to_dict()
                for name, cell in self.cells.items()
            }
        }
        return json.dumps(data, indent=2, ensure_ascii=False)
```

---

## ä¸ç°æœ‰å·¥å…·çš„é›†æˆ

### å½“å‰å·¥å…·å®šä½

| å·¥å…· | å®šä½ | è¯´æ˜ |
|------|------|------|
| `balance.py` | é…å¹³æ£€éªŒ | æ£€æŸ¥ä¸‰è¡¨æ˜¯å¦é…å¹³ |
| `forecast.py` | ç®€å•é¢„æµ‹ | åŸºäºé©±åŠ¨å› å­çš„é¢„æµ‹ |
| **æ–°å»ºæ¨¡å·¥å…·** | å®Œæ•´å»ºæ¨¡ | å¸¦è¿½æº¯çš„ä¸‰è¡¨æ¨¡å‹ |

### é›†æˆæ–¹å¼

```
                    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
                    â”‚  assumptions    â”‚
                    â”‚   (ç”¨æˆ·è¾“å…¥)    â”‚
                    â””â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                             â”‚
                             â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                    financial_model                          â”‚
â”‚                    (æ–°å»ºæ¨¡å·¥å…·)                              â”‚
â”‚                                                             â”‚
â”‚  è¾“å…¥ â†’ è®¡ç®—(å¸¦è¿½æº¯) â†’ è¾“å‡ºJSON                              â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                      â”‚
                      â–¼
              â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
              â”‚  output.json  â”‚
              â”‚  (å¸¦è¿½æº¯ä¿¡æ¯)  â”‚
              â””â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”˜
                      â”‚
          â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
          â–¼           â–¼           â–¼
   â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
   â”‚ balance  â”‚ â”‚  Excel   â”‚ â”‚   Web    â”‚
   â”‚  check   â”‚ â”‚  Writer  â”‚ â”‚   UI     â”‚
   â”‚ (é…å¹³éªŒè¯)â”‚ â”‚ (è¾“å‡ºæŠ¥è¡¨)â”‚ â”‚ (å¯è§†åŒ–) â”‚
   â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

---

## ä¸‹ä¸€æ­¥è®¡åˆ’

1. **Phase 1**: å®ç° `ModelCell` å’Œ `FinancialModel` åŸºç±»
2. **Phase 2**: å®ç°ä¸‰è¡¨è”åŠ¨æ¨¡å‹ï¼ˆå¸¦è¿½æº¯ï¼‰
3. **Phase 3**: å®ç° Excel è¾“å‡ºï¼ˆå¸¦è¿½æº¯æ³¨é‡Šï¼‰
4. **Phase 4**: å®ç° Web UIï¼ˆå¯é€‰ï¼‰
5. **Phase 5**: æ‰©å±•é«˜çº§åŠŸèƒ½ï¼ˆDCFã€é€’å»¶ç¨ç­‰ï¼‰

---

## å‚è€ƒ

- å½“å‰é…å¹³å·¥å…·ï¼š`balance.py`
- å½“å‰é¢„æµ‹è„šæœ¬ï¼š`examples/catl_2025q3/forecast.py`
- æ•°æ®ç»“æ„ç¤ºä¾‹ï¼š`examples/catl_2025q3/output.json`
